# Buckaroo SDK
![GitHub package.json version](https://img.shields.io/github/package-json/v/ZyriabDsgn/buckaroo-sdk)
![GitHub code size in bytes](https://img.shields.io/github/languages/code-size/ZyriabDsgn/buckaroo-sdk)
![GitHub license](https://img.shields.io/github/license/ZyriabDsgn/buckaroo-sdk)


Connect your frontend to your (Buckaroo) backend easily.

## Installation

Until a NPM package is made available, you need to download this repo's content and include it in your frontend folders (you can ommit the packages*.json).  
For example, you can put the files in `your_project/src/utils/buckaroo/`.

You also need a token based authentication (JWT) in order to pass a token to the backend.

Lastly, install the SDK dependencies with the following commands:  
`npm install typescript papaparse normalize-path`  
`npm install -D @types/papaparse @types/normalize-path @types/node dotenv`

I recommend you check out [Buckaroo](https://www.github.com/ZyriabDsgn/Buckaroo) to have the necessary info about the environment variables, auth, etc.

## Usage

Simply import the needed function and use it as shown in the below example.  
You can also import the actual queries made to the backend from the `queries.utils.ts` file.

Each queries refer directly to [Buckaroo's resolvers](https://github.com/ZyriabDsgn/Buckaroo/blob/main/src/graphql/resolvers/resolvers.ts).

**Note**: some parts of this SDK are pretty opinionated because this is a little side-project originally made to be used with ShopiCSV and I upgrade it as I need (i.e.: `RowData` and `getCSVFileContent()`).  
I will eventually make Buckaroo way more multi-usage and less-opinionated as I'd like to transform it as a true utility wrapper for any kind of projects making use of AWS S3.

### Examples

**Note**: Each optional property can be used by superusers, bots, etc to work on other buckets/users

Deleting a file

```ts
import { deleteObject } from './utils/deleteObject';
import generateToken from './utils/auth/generateToken.utls'; // Example function

async function foo() {
  const token = await generateToken();

  const args = {
    filename: 'bar.json',
    path: 'path/to/file',
    versionId: 'abcdefghijklmnopqrstuvwxy', // AWS S3 version ID
    root: 'user_folder', // Automatically generated by Buckaroo based on the auth token metadata
    bucketName: 'bucket_name', // Automatically generated by Buckaroo based on the auth token metadata
    token,
  };

  await delete deleteObject(args);
}
```

Listing bucket content

```ts
import { ListBucketContent, getTextFileContent } from './utils/queries.utils';
import generateToken from './utils/auth/generateToken.utls'; // Example function

async function foo() {
  try {
    let token = await generateToken();

    const args = {
      path: '', // Empty string would list entire content
      userName: '', // Empty string would list all users (if token has the right permissions)
      bucketName: '', // Automatically set through the `Tenant` object in Buckaroo
      token,
    };

    const objects = await ListBucketContent(args);

    // Setting the objects content

    token = await generateToken();
    let content: string;

    for (const obj of objects) {
      content = await getTextFileContent({
        fileName: obj.name,
        path: obj.path,
        versionId: obj.id,
        token,
      });

      obj.content = content;
    }
  } catch (e) {
    console.log(e);
  }
}
```

## Contributing

This project (with Buckaroo) has a long way to go, feel free to send a PR, this is a small side project and if you want to add a feature, spot any error in the code or README, I would appreciate your help ðŸ™‚

## License

This software is under the [MIT](https://choosealicense.com/licenses/mit/) license, a short and simple permissive license with conditions only requiring preservation of copyright and license notices. Licensed works, modifications, and larger works may be distributed under different terms and without source code. (Do whatever you want with it ðŸ¤™).
